<!doctype html>
<html lang="ru">
  <head>
    <meta http-equiv="Content-Language" content="en">
<link rel="alternate" hreflang="en" href="https://penaadventure.com/ru/freebsd/2022/06/29/freebsd-cyrus-sasl2-sysadmin-configuration/"/>

  <meta charset="utf-8">
  
  <title>FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2  UnixBSDShell</title>
  <meta property="og:locale" content="en">
  <meta property="og:site_name" content="UnixBSDShell">
  <meta property="og:title" content="FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2"><link rel="canonical" href="https://penaadventure.com/ru/freebsd/2022/06/29/freebsd-cyrus-sasl2-sysadmin-configuration/">
  <meta property="og:url" content="https://penaadventure.com/ru/freebsd/2022/06/29/freebsd-cyrus-sasl2-sysadmin-configuration/"><meta property="og:description" content="Добавление поддержки аутентификации в Postfix важно для пользователей, которые хотят ретранслировать электронную почту через свои серверы из незащищенных публичных сетей."><meta name="twitter:site" content="@iwanset96143401">
  <meta name="twitter:title" content="FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2">
  <meta name="twitter:description" content="Добавление поддержки аутентификации в Postfix важно для пользователей, которые хотят ретранслировать электронную почту через свои серверы из незащищенных публичных сетей.">
  <meta name="twitter:url" content="https://penaadventure.com/ru/freebsd/2022/06/29/freebsd-cyrus-sasl2-sysadmin-configuration/"><meta name="twitter:card" content="summary"><meta property="og:type" content="article">
  <meta property="article:published_time" content="2022-06-29T18:15:00+03:00"><script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "",
      "url" : "https://penaadventure.com",
      "sameAs" : null
    }
  </script><meta name="google-site-verification" content="googledc9be5e5382da4fd" /><meta name="msvalidate.01" content="BCDF1444D895EBA62C6422C90DF8EA1C"><meta name="yandex-verification" content="69d778baa1dbd371">
  <link href="feed.xml" type="application/atom+xml" rel="alternate" title="UnixBSDShellFeed" />
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script>
    document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  </script>
  <!-- For all browsers -->
  <link rel="stylesheet" href="https://penaadventure.com/assets/css/main.css" />
  <meta http-equiv="cleartype" content="on" />    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000" />
    <meta name="apple-mobile-web-app-title" content="JHW Blog" />
    <meta name="application-name" content="JHW Blog" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="theme-color" content="#ffffff" />
    <meta name="fediverse:creator" content="@jwildeboer@social.wildeboer.net" /><script type='text/javascript' src='//timdinosaur.com/5a/a1/16/5aa1163b15793d4f19e80dbdf2135e99.js'></script>

  <meta http-equiv="Content-Language" content="en">
<meta name="verified-code" content="7e9546f3-7a9d-4d82-b8b4-d8e51e2c6c17">
  <link rel="alternate" hreflang="en" href="https://penaadventure.com/ru/freebsd/2022/06/29/freebsd-cyrus-sasl2-sysadmin-configuration/" />
  
<link rel="alternate" hreflang="en" href="https://penaadventure.com/en" />
<link rel="alternate" hreflang="ru" href="https://penaadventure.com/ru" />

  </head>
  <body class="layout--single">  <!--[if lt IE 9]>
  <div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
  <![endif]--><div class="masthead">
    <div class="masthead__inner-wrap">
      <div class="masthead__menu">
        <nav id="site-nav" class="greedy-nav">
          <ul class="visible-links">
            <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://penaadventure.com/">UnixBSDShell</a></li><li class="masthead__menu-item"><a href="https://penaadventure.com/about/">Me</a></li><li class="masthead__menu-item"><a href="https://penaadventure.com/year-archive/">By Year</a></li><li class="masthead__menu-item"><a href="https://penaadventure.com/categories/">Categories</a></li><li class="masthead__menu-item"><a href="https://penaadventure.com/tags/">Tags</a></li></ul>
          <ul class="hidden-links hidden"></ul>
        </nav>
      </div>
    </div>
  </div>



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://penaadventure.com/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#ru" itemprop="item"><span itemprop="name">Ru</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#freebsd" itemprop="item"><span itemprop="name">Freebsd</span></a>
          <meta itemprop="position" content="3" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#2022" itemprop="item"><span itemprop="name">2022</span></a>
          <meta itemprop="position" content="4" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#06" itemprop="item"><span itemprop="name">06</span></a>
          <meta itemprop="position" content="5" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#29" itemprop="item"><span itemprop="name">29</span></a>
          <meta itemprop="position" content="6" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2</li>
      
    
  </ol>
</nav>
<script type="application/ld+json">

{"@context":"https://schema.org",

"@graph":[

{"@type":"ProfilePage",
"@id": "https://penaadventure.com/#profilepage",
"name": {"name":"UnixBSDShell's Blog","avatar":"auth/JHW500.jpg","avataralt":"Thank you for visiting our site. Have a nice day!.","bio":"penaadventure.com is an online learning platform that provides online tutorials and videos about unix, FreeBSD, OpenBSD and Linux. Not only that, penaadventure.com also presents a variety of topics, including software development, programming, web design, and more. This blog provides various online tutorials and videos for beginners and experienced professionals. This blog also provides a Q&A forum for users to ask questions and get help from other members.","location":"Moscow, Russia"},
"url": "https://penaadventure.com/about-us",
"relatedLink": "httpss://www.github.com/unixbsdshell",
"dateCreated": "2022-06-29 18:15:00 +0300",
"datePublished": "2022-06-29 18:15:00 +0300",
"abstract": "WARNET DAPURNET leverages open-source Linux to provide educational services in Cikarang Barat, Indonesia.",

"mainEntity":[
{"@type":"Person",
"@id": "https://penaadventure.com/#person",
"name": {"name":"UnixBSDShell's Blog","avatar":"auth/JHW500.jpg","avataralt":"Thank you for visiting our site. Have a nice day!.","bio":"penaadventure.com is an online learning platform that provides online tutorials and videos about unix, FreeBSD, OpenBSD and Linux. Not only that, penaadventure.com also presents a variety of topics, including software development, programming, web design, and more. This blog provides various online tutorials and videos for beginners and experienced professionals. This blog also provides a Q&A forum for users to ask questions and get help from other members.","location":"Moscow, Russia"},
"url": "https://penaadventure.com/about-us",
"gender": "male",
"description": "Lahir di Bekasi - Jawa Barat, seorang anak laki-laki yang mendedikasikan dirinya untuk menulis berbagai artikel tentang IT.",
"alternateName": "Iwan Sting",
"additionalName": "setiawan",
"givenName": "Bata",
"familyName": "Om Iwan",
"birthDate": "1977",
"birthPlace": "Kabupaten Bekasi, Provinsi Jawa Barat, Indonesia",
"jobTitle": "Blogger Writer",
"spouse": "Siti Umaroh",  

"homeLocation": 
{ "@type": "Place",
"image": "https://lh3.googleusercontent.com/vLqLiGPo6QmAaoml2wwECAjBD_ZMivRMpakTpgCkGf-foAn3SjzMtxi-9CYKJf8aM1Zgxm8-fgpA8ar4=s265-w265-h265",
"url": "https://lh3.googleusercontent.com/vLqLiGPo6QmAaoml2wwECAjBD_ZMivRMpakTpgCkGf-foAn3SjzMtxi-9CYKJf8aM1Zgxm8-fgpA8ar4=s265-w265-h265",
"hasMap": "https://www.google.com/maps/place/WARNET+DAPURNET/@-6.2697727,107.1165375,17z/data=!3m1!4b1!4m6!3m5!1s0x2e69854270602ca7:0x71e63dfb53b7b95!8m2!3d-6.2697727!4d107.1165375!16s%2Fg%2F11fx88pw2p?entry=ttu",
"photo": "https://maps.app.goo.gl/5e3jR7dbtUypBe2Q8",
"name": "MyHome",
"description": "Dari tugu Warung Bongkok sebelum Pom Bensin/10 mtr arah timur dari tugu bambu runcing/Belakang RM. Padang Selera Bunda",
"identifier": "Tugu Bambu Runcing Warung bongkok"},
"address": {"@type": "PostalAddress",
"addressLocality": "Jawa Barat, Indonesia",
"addressRegion": "Jawa Barat",
"postalCode": "17841",
"telephone": "+62 812 8906 5249",
"email": "datainchi@gmail.com",
"streetAddress": "Jl. Raya Imam Bonjol No.86, Telagamurni, Kec. Cikarang Bar., Kabupaten Bekasi, Jawa Barat 17841"},

"image": {"@type": "ImageObject",
"width": "32",
"height": "32",
"url": "https://lh3.googleusercontent.com/a/ACg8ocINT1yW-xPXQuI4Qku0LW5-QNI-26KpzLWO9_DrPDQWSVJ8gQtu=s288-c-no"}

},

{"@context": "http://schema.org",
"@type": "EducationalOrganization",
"@id": "https://penaadventure.com/#organization",
"url": "https://www.inchimediatama.org/p/organization.html",
"identifier": "https://www.google.com/maps/place/WARNET+DAPURNET/@-6.2697727,107.1139626,17z/data=!3m1!4b1!4m6!3m5!1s0x2e69854270602ca7:0x71e63dfb53b7b95!8m2!3d-6.2697727!4d107.1165375!16s%2Fg%2F11fx88pw2p?entry=ttu/#2425380976366117670",
"name": "Inchimediatama Nusantara",
"foundingDate": "2009",
"slogan": "FreeBSD The Power To Serve",
"knowsAbout": "Tutorials UNIX BSD Linux Windows Opensource",
"knowsLanguage": ["id","en"],
"legalName" : "Inchimediatama Nusantara",
"image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgz6JYLaq1_DkQMs0yJBpGZZve00P5m-7HPxrRIYhDdVng6kHfmZc4x9EW_vI0DyspmFsWtcMenBJzfaummNCefFmTdZr5c8M1IL9l2sufVKbaSVEQs-0feAUpmCkDu4Eo-1rCR60XZ66Ym5BFLYe2dnPHWRHqRp4-OpmJE56J9Z-zhvg/s1600/logo%20unixwinbsd.png",      
"logo": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRDo6ylljwvU7hLVWRd9cIciBEO4sknBzOHQGECuvW5x8ZK6LuFj890M6HCZZM9j61NaqQU3DA1_SJZELqdtiIEdUejC9zkIf_lLDFFgR3dXAQ2l2lqadxk0waF_lYet5olTZX19oEbYHYJSMaBScwIACW1pGs3TtnR7ZCu7P_FqmzX61yUasXjXmPdC6l/s320/Logo%20Inchi%20copy.png",
"address": {"@type": "PostalAddress",
"addressLocality": "Jawa Barat, Indonesia",
"addressRegion": "Jawa Barat",
"addressCountry": "ID",
"postalCode": "17841",
"telephone": "+62 812 8906 5249",
"email": "datainchi@gmail.com",
"streetAddress": "Jl. Raya Imam Bonjol No.86, Telagamurni, Kec. Cikarang Bar., Kabupaten Bekasi, Jawa Barat 17841"},
"location": 
{"@type": "Place",
"geo": {"@type": "GeoCoordinates",
"latitude": "-6.2697727", "longitude": "107.1165375"}
}
}
],

"image":{"@type":"ImageObject",
"@id":"https://penaadventure.com/#logo",
"url": "https://penaadventure.com/img/logo.png",
"caption":"Inchimediatama Nusantara"}


},

{

"@type":"WebSite",
"@id":"https://penaadventure.com/#website",
"url": "https://penaadventure.com",
"inLanguage":"ru",
"name": "UnixBSDShell",
"publisher":{"@id": "https://penaadventure.com/#organization"},
"potentialAction":{"@type":"SearchAction",
"target":"https://penaadventure.com/?s={search_term_string}",
"query-input":"required name=search_term_string"}
},



{"@type":"WebPage",
"@id":"https://penaadventure.com/#webpage",
"url": "https://penaadventure.com",
"inLanguage":"ru",
"name": "FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2",
"isPartOf":
{"@id":"https://penaadventure.com/#website"},

"image": {
"@type": "ImageObject",
"@id":"https://penaadventure.com/#image",
"width": "1200",
"height": "630",
"url": "https://penaadventure.com",
"caption": "Добавление поддержки аутентификации в Postfix важно для пользователей, которые хотят ретранслировать электронную почту через свои серверы из незащищенных публичных сетей."
},

"datePublished": "2022-06-29 18:15:00 +0300",
"dateModified": "2022-06-29 18:15:00 +0300",
"description": "UnixBSDShell",

"breadcrumb":
{"@id":"https://penaadventure.com/#breadcrumb"}
},

{
"@type":"BreadcrumbList",
"@id":"https://penaadventure.com/#breadcrumb",
"itemListElement":[
{"@type":"ListItem",
"position":1,
"item":{"@type":"WebPage",
"@id":"https://penaadventure.com/",
"url": "https://penaadventure.com",
"name": "UnixBSDShell"
}},

{
"@type":"ListItem",
"position":2,
"item":{"@type":"WebPage",
"@id":"https://penaadventure.com/",
"url": "https://penaadventure.com/ru/freebsd/2022/06/29/freebsd-cyrus-sasl2-sysadmin-configuration/",
"name": "FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2"
}},

{

"@type":"ListItem",
"position":3,
"item":{"@type":"WebPage",
"url": "https://penaadventure.com/ru/freebsd/2022/06/29/freebsd-cyrus-sasl2-sysadmin-configuration/",
"name": "SysAdmin"
}}

]},



{  "@type": "BlogPosting",
  "url": "https://penaadventure.com/ru/freebsd/2022/06/29/freebsd-cyrus-sasl2-sysadmin-configuration/",
  "name": "FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2",
  "headline": "FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2",
  "keywords": "SysAdmin",
  "description": "Добавление поддержки аутентификации в Postfix важно для пользователей, которые хотят ретранслировать электронную почту через свои серверы из незащищенных публичных сетей.",
  "articleBody": "SASL (Simple Authentication and Security Layer) — это система для добавления поддержки аутентификации на основе соединения с протоколом. В этой статье мы будем использовать механизм Simple Mail Transfer Protocol (SMTP), а именно Postfix MTA использует SMTP для передачи интернет-почты. Добавление поддержки аутентификации в Postfix важно для пользователей, которые хотят ретранслировать почту через свои серверы из незащищенных публичных сетей. Безопасная ретрансляция почты может быть достигнута путем объединения SASL с шифрованием на основе SSL/TLS.\n\nПо умолчанию Postfix MTA не является открытым ретранслятором электронной почты. Хотя это не позволяет неавторизованным пользователям использовать сервер для доставки спама, это также не позволяет авторизованным пользователям отправлять электронную почту из мест, отличных от локальной частной сети. Cyrus SASL позволяет серверам SMTP проверять личность удаленных пользователей. После аутентификации пользователю предоставляется привилегия удаленной ретрансляции.\n\nДжон Майерс, бывший системный архитектор в Университете Карнеги-Меллона, опубликовал спецификацию SASL в октябре 1997 года. Cyrus SASL поддерживается в рамках проекта Cyrus в Карнеги-Меллоне.\n\nОбсуждение в этой статье особенно актуально для конфигураций Cyrus SASL с Postfix MTA и предполагает, что вы собираетесь использовать SASL с SMTP в сочетании с шифрованием SSL/TLS для защиты методов аутентификации PLAIN и/или LOGIN.\n\nОперационная система, используемая в этой статье, использует FreeBSD 13. Вы можете начать установку сервера аутентификации Cyrus SASL, который включает Cyrus SASL. Чтобы начать установку сервера аутентификации Cyrus SASL, введите следующую команду:\n\nroot@router2:~ # cd /usr/ports/security/cyrus-sasl2-saslauthd\nroot@router2:~ # make config &amp;&amp; make install clean\nroot@router2:~ # rehash\n\n\nПоявится меню с параметрами для запуска процесса установки Cyrus SASL. Просто оставьте эти настройки по умолчанию и нажмите кнопку «Ввод».\n\n\n\nПосле завершения установки security/cyrus-sasl2 отредактируйте файл /usr/local/lib/sasl2/Sendmail.conf или создайте его, если он не существует, и добавьте следующие строки:\n\npwcheck_method: saslauthd\nmech_list: plain login\n\n\nСкрипт выше поясняет, что первая строка указывает Cyrus SASL использовать установленный вами сервер аутентификации SASL. Вторая строка указывает Cyrus SASL объявлять только методы PLAIN и LOGIN, когда клиент изначально подключается к SMTP-серверу.\n\nСледующий шаг — включить автоматический запуск сервера аутентификации SASL при загрузке компьютера. Чтобы настроить автоматический запуск сервера аутентификации SASL при загрузке, добавьте следующий скрипт в файл /etc/rc.conf.\n\nsaslauthd_enable=\"YES\"\nsaslauthd_flags=\"-a pam\"\n\n\nЗапустите демон saslauthd с помощью следующей команды.\n\nroot@router2:~ # service saslauthd restart\n\n\nЭтот демон функционирует как sendmail-брокер для аутентификации с помощью базы данных passwd на FreeBSD. Это избавит вас от необходимости создавать новый набор имен пользователей и паролей для каждого пользователя, которому необходимо использовать SMTP-аутентификацию, и сохранит логин и пароли электронной почты прежними.\n\nЕсли демон saslauthd уже запущен, введите следующий скрипт в файл /etc/make.conf.\n\nroot@router2:~ # ee /etc/make.conf\nSENDMAIL_CFLAGS=-I/usr/local/include/sasl -DSASL\nSENDMAIL_LDFLAGS=-L/usr/local/lib\nSENDMAIL_LDADD=-lsasl2\n\n\nСкрипт выше дает Sendmail правильные параметры конфигурации для связи с cyrus-sasl2 во время компиляции. Убедитесь, что cyrus-sasl2 установлен перед повторной компиляцией Sendmail. Теперь мы продолжим повторную компиляцию Sendmail, выполнив следующую команду:\n\nroot@router2:~ # cd /usr/src/lib/libsmutil\nroot@router2:~ # make cleandir &amp;&amp; make obj &amp;&amp; make\nroot@router2:~ # cd /usr/src/lib/libsm\nroot@router2:~ # make cleandir &amp;&amp; make obj &amp;&amp; make\nroot@router2:~ # cd /usr/src/usr.sbin/sendmail\nroot@router2:~ # make cleandir &amp;&amp; make obj &amp;&amp; make &amp;&amp; make install\n\n\nПосле компиляции и переустановки Sendmail отредактируйте файл /etc/mail/freebsd.mc или локальный файл .mc. Многие администраторы предпочитают использовать вывод имени хоста в качестве имени файла .mc для уникальности. Добавьте эту строку в файл /etc/mail/freebsd.mc и поместите ее в конец файла.\n\nroot@router2:~ # ee /etc/mail/freebsd.mc\ndnl set SASL options\nTRUST_AUTH_MECH(`GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl\ndefine(`confAUTH_MECHANISMS', `GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl\n\n\nПоследний шаг — запустить команду make в /etc/mail, скрипт ниже запустит новый файл расширения .mc и создаст файл расширения .cf с именем freebsd.cf. Введите скрипт ниже, чтобы скопировать файл в sendmail.cf.\n\nroot@router2:~ # cd /etc/mail\nroot@router2:/etc/mail # make install restart\n\n\nПерекомпиляция Sendmail не должна вызвать проблем, если /usr/src не сильно изменился и доступны необходимые зависимости.\n\n",
  "datePublished": "2022-06-29 18:15:00 +0300",
  "dateModified": "2022-06-29 18:15:00 +0300",
  "author": {
    "@type": "Person",
"@id": "https://penaadventure.com/#profilepage",
"name": {"name":"UnixBSDShell's Blog","avatar":"auth/JHW500.jpg","avataralt":"Thank you for visiting our site. Have a nice day!.","bio":"penaadventure.com is an online learning platform that provides online tutorials and videos about unix, FreeBSD, OpenBSD and Linux. Not only that, penaadventure.com also presents a variety of topics, including software development, programming, web design, and more. This blog provides various online tutorials and videos for beginners and experienced professionals. This blog also provides a Q&A forum for users to ask questions and get help from other members.","location":"Moscow, Russia"},
"url": "https://penaadventure.com/about-us",
    "email": {"uri":null,"bitbucket":null,"codeberg":null,"codepen":null,"dribbble":null,"flickr":null,"facebook":null,"foursquare":null,"github":"datainchi@gmail.com","google_plus":null,"instagram":null,"keybase":null,"lastfm":null,"linkedin":"datainchi@gmail.com","mastodon":null,"pinterest":null,"soundcloud":null,"stackoverflow":null,"steemit":null,"steam":null,"tumblr":"datainchi@gmail.com","twitter":null,"vine":null,"weibo":null,"xing":null,"youtube":"datainchi@gmail.com"}
  },
"publisher": {
"@type": "EducationalOrganization",
"@id": "https://penaadventure.com/#organization"  },



  "mainEntityOfPage": {
    "@type": "WebPage",
"@id":"https://penaadventure.com/#webpage"
  },
  "image": {
    "@type": "ImageObject",
"@id":"https://penaadventure.com/#image"
  }
}

]}</script<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SKDSF4Y03H"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SKDSF4Y03H');
</script>

    <!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(95806836, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true,
        webvisor:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/95806836" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
 
    <!-- Clarity tracking code for https://penaadventure.com/ -->
<script>
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i+"?ref=bwt";
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "qrb63393nv");
</script>


<script type="text/javascript">
	atOptions = {
		'key' : '67fb5d6234d340006720e0f69ca5be7f',
		'format' : 'iframe',
		'height' : 90,
		'width' : 728,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//timdinosaur.com/67fb5d6234d340006720e0f69ca5be7f/invoke.js"></script>


<div id="main" role="main"><div class="sidebar sticky"><div itemscope itemtype="http://schema.org/Person">
  <div class="author__avatar"><img src="https://penaadventure.com/images/auth/JHW500.jpg" class="author__avatar" alt="Thank you for visiting our site. Have a nice day!."></div>
  <div class="author__content">
    <h3 class="author__name">UnixBSDShell's Blog</h3><p class="author__bio">penaadventure.com is an online learning platform that provides online tutorials and videos about unix, FreeBSD, OpenBSD and Linux. Not only that, penaadventure.com also presents a variety of topics, including software development, programming, web design, and more. This blog provides various online tutorials and videos for beginners and experienced professionals. This blog also provides a Q&A forum for users to ask questions and get help from other members.</p></div>
  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons"><li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> Moscow, Russia</li></ul>
  </div>
</div></div><article class="page" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="headline" content="FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2"><meta itemprop="description" content="Добавление поддержки аутентификации в Postfix важно для пользователей, которые хотят ретранслировать электронную почту через свои серверы из незащищенных публичных сетей."><meta itemprop="datePublished" content="2022-06-29"><div class="page__inner-wrap"><header><p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Posted:</strong> <time datetime="2022-06-29T18:15:00+03:00">2022-06-29</time> </p><h1 class="page__title" itemprop="headline">FREEBSD SYSADMIN Установка и настройка Cyrus-Sasl2
</h1></header><section class="page__content" itemprop="text">
        <p>SASL (Simple Authentication and Security Layer) — это система для добавления поддержки аутентификации на основе соединения с протоколом. В этой статье мы будем использовать механизм Simple Mail Transfer Protocol (SMTP), а именно Postfix MTA использует SMTP для передачи интернет-почты. Добавление поддержки аутентификации в Postfix важно для пользователей, которые хотят ретранслировать почту через свои серверы из незащищенных публичных сетей. Безопасная ретрансляция почты может быть достигнута путем объединения SASL с шифрованием на основе SSL/TLS.</p>

<p>По умолчанию Postfix MTA не является открытым ретранслятором электронной почты. Хотя это не позволяет неавторизованным пользователям использовать сервер для доставки спама, это также не позволяет авторизованным пользователям отправлять электронную почту из мест, отличных от локальной частной сети. Cyrus SASL позволяет серверам SMTP проверять личность удаленных пользователей. После аутентификации пользователю предоставляется привилегия удаленной ретрансляции.</p>

<p>Джон Майерс, бывший системный архитектор в Университете Карнеги-Меллона, опубликовал спецификацию SASL в октябре 1997 года. Cyrus SASL поддерживается в рамках проекта Cyrus в Карнеги-Меллоне.</p>

<p>Обсуждение в этой статье особенно актуально для конфигураций Cyrus SASL с Postfix MTA и предполагает, что вы собираетесь использовать SASL с SMTP в сочетании с шифрованием SSL/TLS для защиты методов аутентификации PLAIN и/или LOGIN.</p>

<p>Операционная система, используемая в этой статье, использует FreeBSD 13. Вы можете начать установку сервера аутентификации Cyrus SASL, который включает Cyrus SASL. Чтобы начать установку сервера аутентификации Cyrus SASL, введите следующую команду:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@router2:~ # cd /usr/ports/security/cyrus-sasl2-saslauthd
root@router2:~ # make config &amp;&amp; make install clean
root@router2:~ # rehash
</code></pre></div></div>

<p>Появится меню с параметрами для запуска процесса установки Cyrus SASL. Просто оставьте эти настройки по умолчанию и нажмите кнопку «Ввод».</p>

<p><img src="/img/Menu cyrus-sasl-sslauthd.jpg" alt="Menu cyrus-sasl-sslauthd" /></p>

<p>После завершения установки security/cyrus-sasl2 отредактируйте файл /usr/local/lib/sasl2/Sendmail.conf или создайте его, если он не существует, и добавьте следующие строки:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwcheck_method: saslauthd
mech_list: plain login
</code></pre></div></div>

<p>Скрипт выше поясняет, что первая строка указывает Cyrus SASL использовать установленный вами сервер аутентификации SASL. Вторая строка указывает Cyrus SASL объявлять только методы PLAIN и LOGIN, когда клиент изначально подключается к SMTP-серверу.</p>

<p>Следующий шаг — включить автоматический запуск сервера аутентификации SASL при загрузке компьютера. Чтобы настроить автоматический запуск сервера аутентификации SASL при загрузке, добавьте следующий скрипт в файл /etc/rc.conf.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>saslauthd_enable="YES"
saslauthd_flags="-a pam"
</code></pre></div></div>

<p>Запустите демон saslauthd с помощью следующей команды.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@router2:~ # service saslauthd restart
</code></pre></div></div>

<p>Этот демон функционирует как sendmail-брокер для аутентификации с помощью базы данных passwd на FreeBSD. Это избавит вас от необходимости создавать новый набор имен пользователей и паролей для каждого пользователя, которому необходимо использовать SMTP-аутентификацию, и сохранит логин и пароли электронной почты прежними.</p>

<p>Если демон saslauthd уже запущен, введите следующий скрипт в файл /etc/make.conf.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@router2:~ # ee /etc/make.conf
SENDMAIL_CFLAGS=-I/usr/local/include/sasl -DSASL
SENDMAIL_LDFLAGS=-L/usr/local/lib
SENDMAIL_LDADD=-lsasl2
</code></pre></div></div>

<p>Скрипт выше дает Sendmail правильные параметры конфигурации для связи с cyrus-sasl2 во время компиляции. Убедитесь, что cyrus-sasl2 установлен перед повторной компиляцией Sendmail. Теперь мы продолжим повторную компиляцию Sendmail, выполнив следующую команду:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@router2:~ # cd /usr/src/lib/libsmutil
root@router2:~ # make cleandir &amp;&amp; make obj &amp;&amp; make
root@router2:~ # cd /usr/src/lib/libsm
root@router2:~ # make cleandir &amp;&amp; make obj &amp;&amp; make
root@router2:~ # cd /usr/src/usr.sbin/sendmail
root@router2:~ # make cleandir &amp;&amp; make obj &amp;&amp; make &amp;&amp; make install
</code></pre></div></div>

<p>После компиляции и переустановки Sendmail отредактируйте файл /etc/mail/freebsd.mc или локальный файл .mc. Многие администраторы предпочитают использовать вывод имени хоста в качестве имени файла .mc для уникальности. Добавьте эту строку в файл /etc/mail/freebsd.mc и поместите ее в конец файла.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@router2:~ # ee /etc/mail/freebsd.mc
dnl set SASL options
TRUST_AUTH_MECH(`GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl
define(`confAUTH_MECHANISMS', `GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl
</code></pre></div></div>

<p>Последний шаг — запустить команду make в /etc/mail, скрипт ниже запустит новый файл расширения .mc и создаст файл расширения .cf с именем freebsd.cf. Введите скрипт ниже, чтобы скопировать файл в sendmail.cf.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@router2:~ # cd /etc/mail
root@router2:/etc/mail # make install restart
</code></pre></div></div>

<p>Перекомпиляция Sendmail не должна вызвать проблем, если /usr/src не сильно изменился и доступны необходимые зависимости.</p>

</section>
      <footer class="page__meta"><script type="text/javascript">
	atOptions = {
		'key' : '9f0fbeed81ad3c9bfba81d92c5429c29',
		'format' : 'iframe',
		'height' : 60,
		'width' : 468,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//timdinosaur.com/9f0fbeed81ad3c9bfba81d92c5429c29/invoke.js"></script>


        <p class="page__date"><strong><i class="fa fa-fw fa-creative-commons" aria-hidden="true"></i> License: </strong> <a href="https://creativecommons.org/licenses/by/4.0/">By:</a> UnixBSDShell's Blog</p><p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Posted:</strong> <time datetime="2022-06-29T18:15:00+03:00">2022-06-29</time></p><p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords"><a href="https://penaadventure.com/tags/#sysadmin" class="page__taxonomy-item" rel="tag">SysAdmin</a></span>
  </p><p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords"><a href="https://penaadventure.com/categories/#freebsd" class="page__taxonomy-item" rel="tag">FreeBSD</a><span class="sep">, </span><a href="https://penaadventure.com/categories/#ru" class="page__taxonomy-item" rel="tag">ru</a></span>
  </p></footer><nav class="pagination"><a href="https://penaadventure.com/ru/openbsd/2022/02/11/setup-crontab-file-openbsd/" class="pagination--pager" title="Настройка файла crontab в OpenBSD
">Previous</a><a href="https://penaadventure.com/ru/freebsd/2022/09/02/configuration-freebsd-opensearch-certificates-openssl/" class="pagination--pager" title="FreeBSD OpenSearch — настройка подключаемых модулей OpenSearch TLS и сертификатов с помощью OpenSSL
">Next</a></nav></div>
  </article></div><div class="page__footer">
      <footer><!-- start custom footer snippets -->
<!-- end custom footer snippets --><div class="page__footer-follow">
  <ul class="social-icons"><li><a href="https://x.com/iwanset96143401"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li><li><a href="feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Atom Feed</a></li>
    <li><a href="https://penaadventure.com/about/"><i class="fa fa-fw fa-user" aria-hidden="true"></i> About Us</a></li>
  </ul>
</div>
<div class="page__footer-copyright">&copy; 2025 UnixBSDShell. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://www.inchimediatama.org/" rel="dofollow">Minimal Mistakes</a>.</div>
</footer>
    </div><script src="https://penaadventure.com/assets/js/main.min.js"></script></body>
</html>