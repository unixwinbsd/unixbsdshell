---
title: Как установить Redis Cache DB на OpenBSD
date: "2023-05-01 11:00:00 +0300"
id: openbsd-redis.cached-db-install
lang: ru
layout: single
author_profile: true
categories:
  - FreeBSD
excerpt: "Redis можно скомпилировать и использовать в операционных системах Linux, OSX, OpenBSD, NetBSD и FreeBSD."
tags: "DataBase"
keywords: redis, freebsd, cache, openbsd, configuration, setup, server, database
---

Redis часто называют сервером структуры данных. То есть Redis обеспечивает доступ к изменяемым структурам данных посредством серии команд, которые отправляются с использованием клиент-серверной модели с TCP-сокетами и простым протоколом. Таким образом, несколько процессов могут запрашивать и изменять одни и те же структуры данных одинаковым образом.

Redis можно скомпилировать и использовать в операционных системах Linux, OSX, OpenBSD, NetBSD и FreeBSD. Метод кэширования Redis используется на клиентских сайтах Gatsby и WordPress, Nextcloud и других. Этот метод, использующий кэш в памяти, очень хорошо справляется с пиками трафика.

## Что такое кэш Redis?
Кэширование необходимо для обеспечения быстрой и бесперебойной работы пользователей в цифровом мире за счет хранения часто используемых данных в быстродоступном хранилище. Кэширование минимизирует время извлечения данных и снижает нагрузку на серверную часть, позволяя веб-приложениям масштабироваться и эффективно управлять большими объемами трафика. По сути, кэширование способствует повышению оперативности и масштабируемости веб-платформы.

Redis — одна из самых популярных баз данных «ключ-значение», занимающая 4-е место по уровню удовлетворенности пользователей среди баз данных NoSQL. Популярность Redis продолжает расти, и многие компании ищут разработчиков Redis на такие должности, как администраторы баз данных и т. д. Redis — популярное, быстрое хранилище данных в оперативной памяти с открытым исходным кодом, которое используется в качестве базы данных, кэша и посредника между посетителями сайта и администраторами сайта.

По своей сути Redis хранит данные в парах «ключ-значение», что делает извлечение данных чрезвычайно быстрым и эффективным. При использовании в качестве кэша Redis временно хранит часто используемые данные, которые в противном случае было бы дорого извлекать или повторно вычислять. Вот как это работает:

- Извлечение данных: когда приложение запрашивает данные, оно сначала проверяет кэш Redis.
- Успех или неудача: если запрошенные данные найдены в кэше (попадание в кэш), Redis немедленно возвращает данные, что значительно сокращает задержку. Если данные отсутствуют в кэше (сбой кэша), приложение извлечет данные из основной базы данных.
- Хранение данных: после извлечения данные сохраняются в кэше Redis, что позволяет быстрее обрабатывать последующие запросы на те же данные.

Кэширование Redis на стороне клиента также известно как «отслеживание», поскольку Redis представляет собой решение на основе структуры данных, кэширование в Redis может представлять собой строки, хеши, списки, наборы или отсортированные наборы. Этот кэш использует потоки и многие другие структуры данных, и вам также необходимо знать, что для чтения и записи в кэш требуется использование команд GET и SET в Redis.

## Как установить Redis на OpenBSD
Вы можете начать установку Redis на OpenBSD с помощью системы портов или с помощью доступных пакетов PKG. Обычно пользователи OpenBSD предпочитают устанавливать пакеты с помощью PKG. Вы можете выполнить каждую из команд ниже, чтобы начать установку Redis.

```
ns2# pkg_add pecl82-redis
ns2# pkg_add redis
```

### а. Конфигурация Redis
Основной файл конфигурации Redis находится в «/etc/redis» и состоит из следующих файлов:
- redis.conf и
- sentinel.conf

Вы изменяете скрипт в файле redis.conf в соответствии с потребностями и спецификациями вашей системы OpenBSD. Ниже приведен пример файла «/etc/redis/redis/redis.conf», который мы адаптировали к нашим потребностям и используемой нами системе OpenBSD.

```
bind 127.0.0.1 -::1
protected-mode yes
port 6379
daemonize yes
requirepass puncakanjani
tcp-backlog 511
unixsocket /var/run/redis/redis.sock
unixsocketperm 770
timeout 0
tcp-keepalive 300
pidfile /var/run/redis/redis_6379.pid
loglevel notice
syslog-enabled yes
syslog-ident redis
syslog-facility daemon
databases 16
always-show-logo no
set-proc-title yes
proc-title-template "{title} {listen-addr} {server-mode}"
stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
dbfilename dump.rdb
rdb-del-sync-files no
dir /var/redis
replica-serve-stale-data yes
replica-read-only yes
repl-diskless-sync no
repl-diskless-sync-delay 5
repl-diskless-load disabled
replica-priority 100
acllog-max-len 128
maxclients 96
maxmemory-policy noeviction
maxmemory 64mb
```

### б. Включить Redis
После настройки файла redis.conf включите Redis, чтобы его можно было запустить непосредственно в OpenBSD.

```
ns2# rcctl enable redis
ns2# rcctl restart redis
```

Чтобы убедиться, что Redis установлен правильно, проверьте, открыт ли порт Redis.

```
ns2# ps -aux |grep redis
_redis   55721  0.0  0.2 15908  3132 ??  S       4:19PM    0:00.05 redis-server: /usr/local/bin/redis-server 127.0.0.1:6379 (redis-server)
root     83550  0.0  0.0   108   324 p0  R+/0    4:19PM    0:00.00 grep redis
```

Из приведенного выше изображения видно, что Redis активен, поскольку порт 127.0.0.1:6379 открыт, как мы видим выше.

## Как запустить Redis на OpenBSD
Этот процесс нужен для запуска Redis, чтобы его можно было использовать по вашему желанию. Для запуска сервера Redis необходимо использовать команду redis-cli.

### а. Подключиться к серверу Redis
Выполните команду ниже, чтобы подключиться к серверу Redis.

```
ns2# redis-cli
127.0.0.1:6379>
```

### б. Войти на сервер Redis
Даже если вы подключились к серверу Redis, вы пока не можете использовать Redis. Чтобы использовать Redis, нам необходимо ввести пароль, который мы создали в файле /etc/redis/redis.conf выше. В файле выше мы определили пароль «puncakanjani». Используйте этот пароль для входа на сервер Redis.

```
127.0.0.1:6379> auth puncakanjani
OK
```

### в. Создать пользователя
После успешного входа на сервер Redis вы можете делать с Redis все, что угодно. Приведем пример создания пользователя в Redis.

```
127.0.0.1:6379> set name udinsedunia
OK
127.0.0.1:6379> get name
"udinsedunia"
```

На данный момент создана высокодоступная служба RedisCache, вы можете подключить Redis к различным другим приложениям, таким как Wordpress, Nexcloud, Gatsby и другим.

